# 解释网格策略参数含义

我将详细解释这三个参数在代码逻辑中的具体作用，并说明它们与币安（Binance）手动网格设置的区别。

## 1. `capital_ratio` (单格使用资金占比)
- **代码逻辑**: 在 `get_one_grid_quantity` 方法中被使用。
  - 公式: `单格数量 = 初始资金 * 杠杆 * capital_ratio / 网格价格总和`
  - 它决定了**每格挂单的金额**占总投资额的比例。
- **与币安区别**:
  - 币安通常只需你输入“总投入金额”和“网格数量”，系统会自动计算每格买卖数量（通常是平均分配或按等比分配）。
  - 这里暴露这个参数是为了更精细的**资金利用率控制**。
  - 比如设置为 `0.5` (50%)，意味着你只拿一半的钱去跑网格，剩下一半留作备用金（比如用于支付手续费、应对极端行情或手动补仓）。如果设为 `1.0`，就是满仓跑。

## 2. `price_range` (动态区间百分比)
- **代码逻辑**: 在 `_initialize_grid_params` 方法中被使用。
  - 如果 `price_range != 0` (例如 0.2)，则自动计算：
    - `最高价 = 当前价 * (1 + 0.2)`
    - `最低价 = 当前价 * (1 - 0.2)`
  - 如果 `price_range == 0`，则使用配置中固定的 `min_price` 和 `max_price`。
- **与币安区别**:
  - 币安手动创建网格时，必须明确输入“最低价格”和“最高价格”。
  - 这个参数是策略机器人的**便利功能**（懒人模式）。如果你不想去分析支撑压力位，只想简单地跑一个“当前价格上下 20%”的震荡，用这个参数就不用每次手动算价格了。

## 3. `num_hours` (备用时长参数)
- **代码逻辑**: 在 `BacktestEngine.load_data` 中被使用。
  - 它用于计算回测需要加载多少根 K 线数据 (`num_kline = num_hours * 60`)。
  - 主要是为了方便回测数据加载，特别是当你想快速测试“最近 30 天”的表现，而不想去查具体的 `start_time` 和 `end_time` 日期字符串时。
- **与币安区别**:
  - 币安的网格创建页面有一个“终止时间”选项，但通常是选填的。
  - 这个参数主要服务于**回测系统**的数据获取长度，在实盘逻辑中通常对应“运行时长”或仅仅是历史数据预加载长度。

## 总结
这三个参数大多是为了**量化回测的灵活性**和**自动化运行的便利性**而设计的，比交易所的前端 UI 提供了更底层的控制权。

- `capital_ratio`: 它是**仓位管理**参数（你是想全仓干还是半仓干）。
- `price_range`: 它是**自动化定价**参数（相对定价 vs 绝对定价）。
- `num_hours`: 它是**回测数据**参数（测多久的数据）。
